<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Siswa</title>

<style>
body{margin:0;font-family:Arial;background:#f4f6fb;}
.header{
background:#1e90ff;
color:white;
padding:20px;
text-align:center;
}
.card{
background:white;
margin:15px;
padding:20px;
border-radius:15px;
box-shadow:0 5px 15px rgba(0,0,0,0.1);
}
.status{
font-size:20px;
font-weight:bold;
}
.green{color:green;}
.orange{color:orange;}
.red{color:red;}
button{
padding:10px 15px;
border:none;
border-radius:10px;
background:#1e90ff;
color:white;
margin-top:10px;
}
</style>
</head>

<body>

<div class="header">
<h2 id="namaSiswa">-</h2>
<p id="kelasSiswa">-</p>
<h1 id="jam">00:00:00</h1>
<p id="tanggal"></p>
</div>

<div class="card">
<div id="statusHari" class="status">Belum Absen</div>
<button onclick="absen()">ABSEN HADIR</button>
</div>

<div class="card">
<h3>Riwayat Keluar Gerbang</h3>
<p id="riwayatGerbang">Belum ada data</p>
</div>

<div class="card">
<button onclick="logout()">Logout</button>
</div>

<script>

// AMAN walau kosong
let nama=localStorage.getItem("nama") || "Siswa";
let kelas=localStorage.getItem("kelas") || "-";

document.getElementById("namaSiswa").innerText=nama;
document.getElementById("kelasSiswa").innerText=kelas;

function updateJam(){
let now=new Date();
document.getElementById("jam").innerText=now.toLocaleTimeString("id-ID");
document.getElementById("tanggal").innerText=
now.toLocaleDateString("id-ID",{weekday:'long',day:'numeric',month:'long',year:'numeric'});
}
setInterval(updateJam,1000);
updateJam();

function absen(){
let now=new Date();
let menit=now.getHours()*60+now.getMinutes();

let status="HADIR";

if(menit>435){
status="TERLAMBAT";
}

localStorage.setItem("absenHariIni",status);

updateStatus();
}

function updateStatus(){
let status=localStorage.getItem("absenHariIni");

let el=document.getElementById("statusHari");

if(!status){
el.innerText="Belum Absen";
return;
}

if(status==="HADIR"){
el.innerText="HADIR";
el.className="status green";
}

if(status==="TERLAMBAT"){
el.innerText="TERLAMBAT";
el.className="status orange";
}
}

function loadRiwayat(){
let data=localStorage.getItem("statusKeluar");
if(data){
document.getElementById("riwayatGerbang").innerText=data;
}
}

function logout(){
localStorage.clear();
window.location.href="index.html";
}

updateStatus();
loadRiwayat();

</script>

</body>
</html>
